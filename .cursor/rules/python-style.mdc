---
globs: "*.py"
---
# Python Style Guide

- Python 3.12+ required. Use modern syntax: `type` statements, `match/case`, `X | Y` union types.
- Use `ruff` for linting and formatting (configured in root `pyproject.toml`).
- All services use `pydantic-settings` for configuration via environment variables.
- Use `pydantic` v2 models for all data validation and serialization.
- Prefer `async/await` for I/O-bound code (FastAPI, database, MQTT).
- Use `SQLAlchemy 2.0` async API with `asyncpg` driver.
- Type hints are mandatory on all function signatures.
- Use `dataclass` for simple value objects, `pydantic.BaseModel` for validated I/O.
- Each Python service follows `src/` layout: `src/{package_name}/`.
- Imports: stdlib → third-party → first-party (`seld_common`, then local modules).
- Logging: use `structlog` for structured JSON logging.
- Tests: `pytest` with `pytest-asyncio` for async tests.